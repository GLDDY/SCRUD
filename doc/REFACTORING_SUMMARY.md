# ä»£ç é‡æž„æ€»ç»“

## âœ… å·²å®Œæˆçš„é‡æž„

### 1. æ¨¡å—åŒ–æž¶æž„
- âœ… åˆ›å»ºç‹¬ç«‹çš„æ‘„åƒå¤´æ¨¡å—ï¼ˆ`camera_module.c/h`ï¼‰
- âœ… åˆ›å»ºç‹¬ç«‹çš„æœåŠ¡å™¨æ¨¡å—ï¼ˆ`server_module.c/h`ï¼‰
- âœ… åˆ†ç¦»å·¥å…·å‡½æ•°ï¼ˆ`utils.c`ï¼‰

### 2. æ ¸å¿ƒåŠŸèƒ½å®žçŽ°
- âœ… **æˆªå±åŠŸèƒ½**ï¼šç‚¹å‡»æŒ‰é’®è§¦å‘ï¼Œæ‰‹åŠ¨å‘é€å½“å‰å¸§ç»™æ‰€æœ‰å®¢æˆ·ç«¯
- âœ… **é€€å‡ºåŠŸèƒ½**ï¼šç‚¹å‡»æŒ‰é’®ä¼˜é›…é€€å‡ºï¼Œå®Œæ•´æ¸…ç†èµ„æº
- âœ… **å–æ¶ˆè‡ªåŠ¨å‘é€**ï¼šä¸å†æŒç»­å‘é€30fpsè§†é¢‘æµ

### 3. æŠ€æœ¯æ”¹è¿›
- âœ… å®Œæ•´çš„çº¿ç¨‹å®‰å…¨æœºåˆ¶
- âœ… å®¢æˆ·ç«¯è¿žæŽ¥ç®¡ç†
- âœ… ä¼˜é›…çš„èµ„æºæ¸…ç†
- âœ… æ¨¡å—é—´è§£è€¦

## ðŸ“ æ–°å¢žæ–‡ä»¶

```
camera_module.c    # æ‘„åƒå¤´æ¨¡å—å®žçŽ°
camera_module.h    # æ‘„åƒå¤´æ¨¡å—å¤´æ–‡ä»¶
server_module.c    # æœåŠ¡å™¨æ¨¡å—å®žçŽ°
server_module.h    # æœåŠ¡å™¨æ¨¡å—å¤´æ–‡ä»¶
utils.c            # å·¥å…·å‡½æ•°
REFACTORING_GUIDE.md  # è¯¦ç»†é‡æž„æ–‡æ¡£
```

## ðŸ”§ ä¿®æ”¹æ–‡ä»¶

```
main.c          # ç®€åŒ–ä¸»ç¨‹åºé€»è¾‘
module.c        # é‡å†™è§†é¢‘ç›‘æŽ§é›†æˆ
common.h        # æ›´æ–°å…¬å…±å¤´æ–‡ä»¶
Makefile        # æ›´æ–°ç¼–è¯‘é…ç½®
```

## ðŸŽ® ä½¿ç”¨æ–¹æ³•

### è§¦æ‘¸å±æ“ä½œ
1. **å¯åŠ¨**ï¼šç‚¹å‡»"è¿›å…¥"æŒ‰é’®å¯åŠ¨è§†é¢‘ç›‘æŽ§
2. **æˆªå±**ï¼šç‚¹å‡»å±å¹•å³ä¾§ä¸Šæ–¹åŒºåŸŸï¼ˆx: 640-800, y: 0-240ï¼‰
3. **é€€å‡º**ï¼šç‚¹å‡»å±å¹•å³ä¾§ä¸‹æ–¹åŒºåŸŸï¼ˆx: 640-800, y: 240-480ï¼‰

### ç¼–è¯‘éƒ¨ç½²
```bash
# ç¼–è¯‘
make server

# éƒ¨ç½²åˆ°å¼€å‘æ¿
make deploy BOARD_IP=192.168.1.100

# è¿è¡Œ
./video_server
```

## ðŸŒŸ æ ¸å¿ƒæ”¹è¿›

### ä¹‹å‰çš„é—®é¢˜
- âŒ æ‘„åƒå¤´å’ŒæœåŠ¡å™¨è€¦åˆä¸¥é‡
- âŒ è‡ªåŠ¨å‘é€è§†é¢‘æµï¼Œæ— æ³•æŽ§åˆ¶
- âŒ æ— æ³•æ‰‹åŠ¨è§¦å‘æˆªå±
- âŒ æ²¡æœ‰é€€å‡ºæœºåˆ¶

### çŽ°åœ¨çš„ä¼˜åŠ¿
- âœ… æ¨¡å—å®Œå…¨åˆ†ç¦»ï¼Œæ˜“äºŽç»´æŠ¤
- âœ… æŒ‰éœ€å‘é€ï¼ŒèŠ‚çœå¸¦å®½å’Œèµ„æº
- âœ… ç”¨æˆ·ä¸»åŠ¨æŽ§åˆ¶æˆªå±æ—¶æœº
- âœ… ä¼˜é›…é€€å‡ºï¼Œå®Œæ•´èµ„æºæ¸…ç†

## ðŸ“Š æž¶æž„å¯¹æ¯”

### æ—§æž¶æž„
```
main.c
  â””â”€â”€ video_server.c (æ‘„åƒå¤´+æœåŠ¡å™¨æ··åˆ)
      â”œâ”€â”€ cameraæ“ä½œ
      â””â”€â”€ ç½‘ç»œé€šä¿¡
```

### æ–°æž¶æž„
```
main.c
  â””â”€â”€ module.c (é›†æˆå±‚)
      â”œâ”€â”€ camera_module (æ‘„åƒå¤´å±‚)
      â”‚   â””â”€â”€ camera.c (é©±åŠ¨å±‚)
      â””â”€â”€ server_module (æœåŠ¡å™¨å±‚)
          â””â”€â”€ ç½‘ç»œé€šä¿¡
```

## ðŸ” å…³é”®ä»£ç ç‰‡æ®µ

### æˆªå±åŠŸèƒ½
```c
// ç”¨æˆ·ç‚¹å‡»æˆªå±æŒ‰é’®
if (pt.x >= 640 && pt.x <= 800 && pt.y >= 0 && pt.y <= 240) {
    printf("ç‚¹å‡»äº†'æˆªå±'æŒ‰é’®\n");
    server_module_send_capture(g_srv_module);
}
```

### é€€å‡ºåŠŸèƒ½
```c
// ç”¨æˆ·ç‚¹å‡»é€€å‡ºæŒ‰é’®
if (pt.x >= 640 && pt.x <= 800 && pt.y >= 240 && pt.y <= 480) {
    printf("ç‚¹å‡»äº†'é€€å‡º'æŒ‰é’®\n");
    *exit_flag = 1;
    g_system_running = 0;
}
```

## ðŸ“ ä¸‹ä¸€æ­¥

æŸ¥çœ‹ `REFACTORING_GUIDE.md` èŽ·å–ï¼š
- è¯¦ç»†çš„æž¶æž„è¯´æ˜Ž
- å®Œæ•´çš„APIæ–‡æ¡£
- çº¿ç¨‹æž¶æž„å›¾
- ä½¿ç”¨ç¤ºä¾‹
- ä¼˜åŒ–å»ºè®®
